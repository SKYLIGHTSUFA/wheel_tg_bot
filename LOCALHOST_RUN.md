# Настройка localhost.run

localhost.run - это бесплатный сервис для создания SSH туннелей, который позволяет пробросить локальный сервер в интернет.

## Быстрый старт

### Вариант 1: Использование скрипта

```bash
./setup_localhost_run.sh
```

### Вариант 2: Ручная настройка

1. Убедитесь, что бот запущен на порту 8000:
   ```bash
   python bot.py
   ```

2. В другом терминале создайте SSH туннель:
   ```bash
   ssh -R 80:localhost:8000 ssh.localhost.run
   ```

3. После подключения вы получите URL вида:
   ```
   https://xxxxx.localhost.run
   ```

4. Установите переменную окружения:
   ```bash
   export WEBAPP_URL=https://xxxxx.localhost.run
   ```

   Или добавьте в `.env` файл:
   ```
   WEBAPP_URL=https://xxxxx.localhost.run
   ```

5. Перезапустите бота с новой переменной окружения.

## Важные замечания

- **URL меняется**: При каждом переподключении localhost.run может выдать новый URL. Если нужен постоянный URL, рассмотрите другие варианты (ngrok с платным планом, собственный домен и т.д.)

- **SSH ключ**: При первом использовании localhost.run может попросить подтвердить SSH ключ. Введите `yes`.

- **Порт**: По умолчанию бот работает на порту 8000. Если используете другой порт, измените команду:
  ```bash
  ssh -R 80:localhost:ВАШ_ПОРТ ssh.localhost.run
  ```

- **HTTPS**: localhost.run автоматически предоставляет HTTPS, что необходимо для Telegram WebApp.

## Альтернативные команды

Если стандартная команда не работает, попробуйте:

```bash
# С указанием порта SSH
ssh -p 443 -R 80:localhost:8000 ssh.localhost.run

# С указанием имени хоста
ssh -R xxxxx:80:localhost:8000 ssh.localhost.run
```

## Автоматизация

Для автоматического получения URL можно использовать:

```bash
# Получить URL из вывода SSH
ssh -R 80:localhost:8000 ssh.localhost.run 2>&1 | grep -oP 'https://[a-z0-9]+\.localhost\.run' | head -1
```

Однако проще всего установить URL вручную после первого подключения.
